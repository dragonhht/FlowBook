<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>图书信息</title>
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
    <script th:src="@{/js/jquery-3.2.1.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <link rel="stylesheet" th:href="@{/css/book_information.css}" />
    <script th:src="@{/js/book_information.js}" ></script>
</head>
<body>
<!--顶部-->
<div class="top_logo">
        <span class="logo_img">
            <img th:src="@{/img/flowbook1.png}" />
        </span>
    <ul id="top_ul">
        <li>
            <th:block th:if="${session.user eq null}">
                <a th:href="@{/login}" onclick="selectNav(this)">登录</a> |
                <a th:href="@{/register}" onclick="selectNav(this)">注册</a>
            </th:block>
            <th:block th:unless="${session.user eq null}">
                <a th:href="@{/user/userHome}" onclick="selectNav(this)" th:text="${session.user.getUserName()}"></a> |
                <a th:href="@{/user/logout}" onclick="selectNav(this)">注销</a>
            </th:block>

        </li>
        <li><a href="#" onclick="selectNav(this)">活动</a></li>
        <li><a th:href="@{/notice}" onclick="selectNav(this)">公告</a></li>
        <li><a th:href="@{/index}" onclick="selectNav(this)" style="color: gray;">首页</a></li>
    </ul>
</div>

    <!--页面中部-->
    <div class="center_bg">
        <div class="center_search" id="center_search">
            <form class="form-inline" action="#" method="post">
                <ul class="nav nav-tabs" id="search_ul" style="width: 500px">
                    <li class="active" onclick="selectSearchType(this)"><a>书名</a></li>
                    <li onclick="selectSearchType(this)"><a>作者</a></li>
                    <li onclick="selectSearchType(this)"><a>出版社</a></li>
                    <li onclick="selectSearchType(this)"><a>用户</a></li>
                </ul>
                <div class="search_input_div">
                    <input type="text" hidden="hidden" value="书名" id="search_flag" />
                    <input type="text" class="search_input" placeholder="请输入您要搜索的内容" />
                    <button type="submit" class="btn btn-lg btn-warning">搜索</button>
                </div>
            </form>
        </div>

        <div class="book_img">
            图片
        </div>

        <div class="book_message">
            <div class="book_name book_message_message" th:text="${book.bookName}"></div>

            <div class="book_author book_message_message">
                <label>作者：</label>
                <span th:text="${book.author}"></span>
            </div>

            <div class="book_publish book_message_message">
                <label>出版社：</label>
                <span th:text="${book.publish}"></span>
            </div>

            <div class="book_now_owner book_message_message">
                <label>当前拥有者：</label>
                <div class="user_message">
                    <a th:href="@{/tourist/user/{userId} (userId = ${nowOwner.userId})}">
                        <img th:src="@{${nowOwner.userImg}}" title="用户名" class="img-circle" />
                    </a>
                    <span><a th:href="@{/tourist/user/{userId} (userId = ${nowOwner.userId})}"
                             th:text="${nowOwner.userName}"></a> </span>
                    <!--<span class="date">2017年07月07日 16:00</span>-->
                </div>
            </div>

            <div class="book_start book_message_message">
                <label>图书评分: </label>
                五星显示
            </div>

            <div class="book_id book_message_message">
                <label>图书漂流编号： </label>
                <span th:text="${book.bookId}"></span>
            </div>

            <div class="book_route book_message_message">
                <span>
                    <a href="user.html">想看这本书</a>
                </span>
            </div>

            <div class="book_introduction book_message_message">
                <label>图书简介：</label>
                <textarea th:text="${book.introduction}"></textarea>
            </div>

        </div>

        <div class="book_img_small">
            <div class="small_img_div">
                小图
            </div>
        </div>

        <div class="book_comment book_comment_div">

            <ul class="nav nav-tabs" id="nav_tabs">
                <li class="active" index="0" onclick="selectTab(this)"><a th:text="${'累计(' + commentSize +')条评论'}"></a></li>
                <li index="1" onclick="selectTab(this)"><a>漂流路线</a></li>
            </ul>

            <!--评论-->
            <div class="book_comment" id="book_comment">
                <!--<span class="book_comment_title">累计()条评论</span>-->

                <!--评论-->
                <div class="comment_div" th:each="comment : ${book.comments}">
                    <img th:src="@{${comment.user.userImg}}" class="img-circle" />
                    <span class="user_name">
                        <a th:href="@{/tourist/user/{userId} (userId = ${comment.user.userId})}"
                           th:text="${comment.user.userName}"></a>
                    </span><br/>
                    <span class="comment_date" th:text="${comment.commentDate}"></span>
                    <div class="comment_text_div" th:text="${comment.commentText}"></div>
                </div>

                <div class="post_comment_div">
                    <span class="post_comment_title">我要评论</span>
                    <form th:action="@{/user/comment}" method="post">
                        <input type="text" th:value="${book.bookId}" name="bookId" hidden="hidden" />
                        <textarea  name="text"></textarea><br/>
                        <button type="submit" onclick="return loginTip();" class="btn btn-primary">提交评论</button>
                    </form>
                </div>
            </div>

            <div id="route" hidden="hidden">
                <ul class="pagination">
                    <li class="active"><a>表格</a></li>
                    <li ><a>流线图</a></li>
                </ul>

                <table id="route_table" class="table table-striped">
                    <tr>
                        <td>日期</td>
                        <td>借阅人</td>
                        <td>评价</td>
                    </tr>
                    <tr th:each="record : ${records}">
                        <td th:text="${record.recordDate}"></td>
                        <td th:text="${record.user.userName}"></td>
                        <td th:text="${record.recordText}"></td>
                    </tr>
                </table>
            </div>
        </div>

    </div>

    <p id="back-to-top"><a href="#top">回到<br/>顶部</a></p>


    <!--底部-->
    <div class="footer" align="center">
        <p class="copyright">
            Copyright © 2017. All Rights Reserved by dragonhht from
            <a href="https://github.com/dragonhht" title="Github" target="_blank" style="color: gray;">dragonhht</a>
        </p>
    </div>

<script th:inline="javascript">
    //点赞判断是否登录
    function loginTip() {
        var user = [[${session.user}]];
        if (user == null) {
            if (window.confirm("请先登录!")) {
                window.location.replace("../../login");
                return false;
            } else {
                return false;
            }
        }
        return true;
    }
</script>
</body>
</html>